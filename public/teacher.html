<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Teacher - Realtime Classroom</title>
</head>
<body>
  <h1>Teacher View</h1>

  <video id="teacherVideo" autoplay playsinline></video>
  <div>
    <h2>Students</h2>
    <ul id="studentsList"></ul>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io(); // يستخدم نفس الدومين الخارجي

    const videoElement = document.getElementById('teacherVideo');
    const studentsList = document.getElementById('studentsList');

    // الانضمام كمدرس
    socket.emit('join-room', 'teacher');

    // الحصول على الكاميرا والميكروفون
    navigator.mediaDevices.getUserMedia({ video: true, audio: true })
      .then(stream => {
        videoElement.srcObject = stream;
      })
      .catch(err => console.error('Error accessing media devices', err));

    // ظهور الطلاب عند الانضمام
    socket.on('student-joined', (studentId) => {
      const li = document.createElement('li');
      li.id = studentId;
      li.innerHTML = `
        ${studentId} 
        <button onclick="toggleMic('${studentId}', true)">Enable Mic</button>
        <button onclick="toggleMic('${studentId}', false)">Disable Mic</button>
      `;
      studentsList.appendChild(li);
    });

    // تفعيل/تعطيل المايك للطالب
    function toggleMic(studentId, enable) {
      socket.emit('toggle-mic', { studentId, enable });
    }
  </script>
</body>
</html>



